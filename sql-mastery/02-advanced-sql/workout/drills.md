# Workout: Advanced SQL

## Drill 1: Basic CTE 游릭

```sql
-- Write CTE to get active users, then filter by date
```

## Drill 2: Multiple CTEs 游리

```sql
-- Chain 2 CTEs: user_stats, active_users
-- Join them to show messages per active user
```

## Drill 3: ROW_NUMBER 游리

```sql
-- Rank products by sales within each category
```

## Drill 4: LAG/LEAD 游리

```sql
-- Calculate day-over-day change in revenue
```

## Drill 5: Running Total 游리

```sql
-- Calculate running total and 7-day rolling average
```

## Drill 6: JSONB Extract 游리

```sql
-- Extract nested values from metadata column
```

## Drill 7: Lateral Join 游댮

```sql
-- Get top 3 messages per user
```

## Drill 8: Recursive CTE 游댮

```sql
-- Build org hierarchy tree with levels
```

## Drill 9: UPSERT 游리

```sql
-- INSERT ON CONFLICT DO UPDATE
```

## Drill 10: Conditional Aggregation 游리

```sql
-- Count by role using FILTER
```

---

## Self-Check

- [ ] Can write CTEs and recursive CTEs
- [ ] Can use window functions
- [ ] Can query and modify JSONB
- [ ] Can write complex joins
